<!DOCTYPE html>
<html lang="ja">

<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YS6TVXQFMJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YS6TVXQFMJ');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ココフォリアのログをエクセルのブックに変換するツール</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <h1>ココフォリアのログをエクセルのブックに変換するツール</h1>

        <div class="description-toggle" onclick="toggleDescription()">使い方を表示</div>
        <div class="description-content" id="description">
            <p>ココフォリアのログをxlsx形式(excelのブック)に変換するツールです。<br>タブ名=シート名でそれぞれ分かれたログが出力されるほか、すべての発言をまとめた[all]シートも出力されます。</p>
            <p><strong>使い方</strong></p>
            <p>1. ココフォリアのログをアップロードします。</p>
            <p>2. 「変換」ボタンをクリックします。</p>
            <p>3. 変換が完了したら、「Excelブックをダウンロード」リンクが表示されます。</p>
            <p>4. リンクをクリックして.xlsxをダウンロードします。</p>
        </div>

        <div class="options">
            <input type="file" id="fileInput" accept=".html">
        </div>

        <div id="outputOptions" style="display: none;">
            <h3>出力オプション</h3>
            <div class="output-format">
                <label><input type="radio" name="format" value="xlsx" checked> XLSX</label>
                <label><input type="radio" name="format" value="csv"> CSV</label>
            </div>
            <div id="tabSelection">
                <h4>変換するタブを選択してください:</h4>
            </div>
            <button id="convertButton">変換</button>
        </div>

        <div id="downloadLink"></div>

        <div class="footer">
            <details class="update-history">
                <summary>更新履歴</summary>
                <p>2024-12-20: 公開</p>
            </details>
            <details class="author-info">
                <summary>作者情報</summary>
                <p>作者：しるべ(<a href="https://x.com/qxoiUioxp" target="_blank"
                        rel="noopener noreferrer">https://x.com/qxoiUioxp</a>)</p>
            </details>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>
